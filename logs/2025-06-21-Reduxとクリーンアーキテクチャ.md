# Reduxã¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

- **å­¦ç¿’æ—¥**: 2025/06/21
- **å­¦ç¿’æ™‚é–“**: 45åˆ†
- **åŠ¹æœå®Ÿæ„Ÿ**: 4/5
- **åŠ¹æœã®ç¨®é¡**: ç†è§£ãŒæ·±ã¾ã£ãŸ

## å†…å®¹

# Redux Toolkit ã§å®Ÿç¾ã™ã‚‹ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼šå¤‰åŒ–ã«å¼·ã„ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨­è¨ˆ

## ğŸš€ ã¯ã˜ã‚ã«

ç¾ä»£ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã«ãŠã„ã¦ã€ã€Œå¤‰åŒ–ã«å¼·ã„è¨­è¨ˆã€ã¯å˜ãªã‚‹ç†æƒ³ã§ã¯ãªãã€**ãƒ“ã‚¸ãƒã‚¹ã®æˆåŠŸã‚’å·¦å³ã™ã‚‹é‡è¦ãªè¦ç´ **ã§ã™ã€‚

ã‚ãªãŸãŒNext.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã—ã¦ã„ã¦ã€ã“ã‚“ãªçµŒé¨“ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ

- ã€ŒSupabaseã‹ã‚‰Firebaseã«å¤‰æ›´ã—ãŸã„ã‘ã©ã€å½±éŸ¿ç¯„å›²ãŒå¤§ãã™ãã‚‹...ã€
- ã€Œæ–°ã—ã„APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«å¯¾å¿œã™ã‚‹ãŸã‚ã«ã€ã‚ã¡ã“ã¡ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä¿®æ­£ã—ã¦ã„ã‚‹ã€
- ã€Œãƒ†ã‚¹ãƒˆã‚’æ›¸ããŸã„ã‘ã©ã€ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ­ã‚¸ãƒƒã‚¯ãŒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ç›´æ¥åŸ‹ã‚è¾¼ã¾ã‚Œã¦ã„ã¦é›£ã—ã„ã€

ã“ã‚Œã‚‰ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ã®ãŒã€**Redux Toolkit Ã— ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**ã®çµ„ã¿åˆã‚ã›ã§ã™ã€‚

## ğŸ—ï¸ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ ¸å¿ƒæ€æƒ³

### ä¾å­˜é–¢ä¿‚ã®é€†è»¢åŸç†

ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æœ€ã‚‚é‡è¦ãªæ¦‚å¿µã¯ã€Œ**ä¾å­˜é–¢ä¿‚ã®é€†è»¢**ã€ã§ã™ã€‚

```
âŒ å¾“æ¥ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
UI â†’ API â†’ Database

âœ… ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
UI â†’ UseCase â†’ Interface â† Repository â†’ Database
```

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆï¼š**

- UIã¯ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«ä¾å­˜ã™ã‚‹
- ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¾å­˜ã™ã‚‹
- å®Ÿè£…ï¼ˆRepositoryï¼‰ãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¾å­˜ã™ã‚‹

### 4ã¤ã®å±¤ã®å½¹å‰²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¨ Presentation Layer (UI)                     â”‚
â”‚  - Components, Pages, Hooks                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¯ Application Layer (UseCases)                â”‚
â”‚  - Business Logic, Redux Slices                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”Œ Domain Layer (Interfaces)                   â”‚
â”‚  - Repository Interfaces, Domain Models         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”§ Infrastructure Layer (Implementation)       â”‚
â”‚  - API Clients, Database Access                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ Redux Toolkit ã¨ã®çµ±åˆæˆ¦ç•¥

### 1. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
src/
â”œâ”€â”€ features/
â”‚   â””â”€â”€ logs/
â”‚       â”œâ”€â”€ domain/
â”‚       â”‚   â”œâ”€â”€ models/
â”‚       â”‚   â”‚   â””â”€â”€ Log.ts              # Domain Model
â”‚       â”‚   â””â”€â”€ repositories/
â”‚       â”‚       â””â”€â”€ ILogRepository.ts    # ğŸ›¡ï¸ å®ˆã‚‹ã¹ããƒ•ã‚¡ã‚¤ãƒ«
â”‚       â”œâ”€â”€ application/
â”‚       â”‚   â”œâ”€â”€ useCases/
â”‚       â”‚   â”‚   â””â”€â”€ fetchLogsByUnitId.ts # ğŸ›¡ï¸ å®ˆã‚‹ã¹ããƒ•ã‚¡ã‚¤ãƒ«
â”‚       â”‚   â””â”€â”€ store/
â”‚       â”‚       â””â”€â”€ logsSlice.ts         # ğŸ›¡ï¸ å®ˆã‚‹ã¹ããƒ•ã‚¡ã‚¤ãƒ«
â”‚       â”œâ”€â”€ infrastructure/
â”‚       â”‚   â””â”€â”€ repositories/
â”‚       â”‚       â”œâ”€â”€ supabaseLogRepository.ts  # ğŸ”§ å¤‰æ›´ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«
â”‚       â”‚       â””â”€â”€ firebaseLogRepository.ts  # ğŸ”§ å¤‰æ›´ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«
â”‚       â””â”€â”€ presentation/
â”‚           â”œâ”€â”€ components/
â”‚           â”‚   â””â”€â”€ LogCard.tsx
â”‚           â””â”€â”€ hooks/
â”‚               â””â”€â”€ useLogActions.ts
â””â”€â”€ shared/
    â”œâ”€â”€ store/
    â”‚   â””â”€â”€ index.ts                     # DI Container
    â””â”€â”€ infrastructure/
        â””â”€â”€ api/
            â””â”€â”€ apiClient.ts
```

### 2. Domain Layer ã®è¨­è¨ˆ

#### Domain Model

```typescript
// src/features/logs/domain/models/Log.ts
export interface Log {
  id: number;
  unitId: number;
  userId: string;
  title: string;
  note: string | null;
  learningTime: number | null;
  logDate: Date;
  effectScore: number | null;
  effectType: string | null;
  createdAt: Date;
  updatedAt: Date;
}

export interface CreateLogRequest {
  unitId: number;
  title: string;
  note?: string;
  learningTime?: number;
  logDate: Date;
  effectScore?: number;
  effectType?: string;
}
```

#### Repository Interface

```typescript
// src/features/logs/domain/repositories/ILogRepository.ts
import { Log, CreateLogRequest } from "../models/Log";

export interface ILogRepository {
  findByUnitId(unitId: number): Promise<Log[]>;
  findById(id: number): Promise<Log | null>;
  create(request: CreateLogRequest): Promise<Log>;
  update(id: number, request: Partial<CreateLogRequest>): Promise<Log>;
  delete(id: number): Promise<void>;
}

// ğŸ›¡ï¸ ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¤‰æ›´ã•ã‚Œãªã„
// ãªãœãªã‚‰ã€ã€Œä½•ã‚’ã™ã‚‹ã‹ã€ã¯å¤‰ã‚ã‚‰ãªã„ã‹ã‚‰
```

### 3. Application Layer ã®å®Ÿè£…

#### UseCase ã®å®Ÿè£…

```typescript
// src/features/logs/application/useCases/fetchLogsByUnitId.ts
import { createAsyncThunk } from "@reduxjs/toolkit";
import { ILogRepository } from "../../domain/repositories/ILogRepository";
import { Log } from "../../domain/models/Log";

export const fetchLogsByUnitId = createAsyncThunk<
  Log[],
  number,
  { extra: { logRepository: ILogRepository } }
>(
  "logs/fetchByUnitId",
  async (unitId: number, { extra: { logRepository } }) => {
    return await logRepository.findByUnitId(unitId);
  }
);

export const createLog = createAsyncThunk<
  Log,
  CreateLogRequest,
  { extra: { logRepository: ILogRepository } }
>(
  "logs/create",
  async (request: CreateLogRequest, { extra: { logRepository } }) => {
    return await logRepository.create(request);
  }
);

// ğŸ›¡ï¸ ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å¤‰æ›´ã•ã‚Œãªã„
// ãƒ“ã‚¸ãƒã‚¹ã®æ„å›³ï¼ˆã€Œãƒ­ã‚°ã‚’å–å¾—ã™ã‚‹ã€ï¼‰ã¯å¤‰ã‚ã‚‰ãªã„ã‹ã‚‰
```

#### Redux Slice ã®å®Ÿè£…

```typescript
// src/features/logs/application/store/logsSlice.ts
import { createSlice, PayloadAction } from "@reduxjs/toolkit";
import { Log } from "../../domain/models/Log";
import { fetchLogsByUnitId, createLog } from "../useCases/fetchLogsByUnitId";

interface LogsState {
  logs: Log[];
  loading: boolean;
  error: string | null;
}

const initialState: LogsState = {
  logs: [],
  loading: false,
  error: null,
};

const logsSlice = createSlice({
  name: "logs",
  initialState,
  reducers: {
    clearError: (state) => {
      state.error = null;
    },
  },
  extraReducers: (builder) => {
    builder
      // å–å¾—
      .addCase(fetchLogsByUnitId.pending, (state) => {
        state.loading = true;
        state.error = null;
      })
      .addCase(fetchLogsByUnitId.fulfilled, (state, action) => {
        state.loading = false;
        state.logs = action.payload;
      })
      .addCase(fetchLogsByUnitId.rejected, (state, action) => {
        state.loading = false;
        state.error = action.error.message || "Failed to fetch logs";
      })
      // ä½œæˆ
      .addCase(createLog.fulfilled, (state, action) => {
        state.logs.push(action.payload);
      });
  },
});

export const { clearError } = logsSlice.actions;
export default logsSlice.reducer;

// ğŸ›¡ï¸ ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯åŸºæœ¬çš„ã«å¤‰æ›´ã•ã‚Œãªã„
// ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹æ§‹é€ ã¯å®‰å®šã—ã¦ã„ã‚‹ã¹ã
```

### 4. Infrastructure Layer ã®å®Ÿè£…

#### Supabase Repository Implementation

```typescript
// src/features/logs/infrastructure/repositories/supabaseLogRepository.ts
import { ILogRepository } from "../../domain/repositories/ILogRepository";
import { Log, CreateLogRequest } from "../../domain/models/Log";
import { supabase } from "@/lib/supabaseClient";

export class SupabaseLogRepository implements ILogRepository {
  async findByUnitId(unitId: number): Promise<Log[]> {
    const { data, error } = await supabase
      .from("logs")
      .select("*")
      .eq("unit_id", unitId)
      .order("log_date", { ascending: false });

    if (error) throw new Error(error.message);

    return data.map(this.toDomain);
  }

  async create(request: CreateLogRequest): Promise<Log> {
    const { data, error } = await supabase
      .from("logs")
      .insert([this.toInfrastructure(request)])
      .select()
      .single();

    if (error) throw new Error(error.message);

    return this.toDomain(data);
  }

  private toDomain(data: any): Log {
    return {
      id: data.id,
      unitId: data.unit_id,
      userId: data.user_id,
      title: data.title,
      note: data.note,
      learningTime: data.learning_time,
      logDate: new Date(data.log_date),
      effectScore: data.effect_score,
      effectType: data.effect_type,
      createdAt: new Date(data.created_at),
      updatedAt: new Date(data.updated_at),
    };
  }

  private toInfrastructure(domain: CreateLogRequest): any {
    return {
      unit_id: domain.unitId,
      title: domain.title,
      note: domain.note,
      learning_time: domain.learningTime,
      log_date: domain.logDate.toISOString(),
      effect_score: domain.effectScore,
      effect_type: domain.effectType,
    };
  }
}

// ğŸ”§ ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¤‰æ›´ã•ã‚Œã‚‹
// æŠ€è¡“çš„ãªéƒ½åˆï¼ˆAPIã®å¤‰æ›´ã€DBæ§‹é€ ã®å¤‰æ›´ï¼‰ã§é »ç¹ã«æ›´æ–°ã•ã‚Œã‚‹
```

#### Firebase Repository Implementation

```typescript
// src/features/logs/infrastructure/repositories/firebaseLogRepository.ts
import { ILogRepository } from "../../domain/repositories/ILogRepository";
import { Log, CreateLogRequest } from "../../domain/models/Log";
import {
  collection,
  query,
  where,
  orderBy,
  getDocs,
  addDoc,
} from "firebase/firestore";
import { db } from "@/lib/firebaseConfig";

export class FirebaseLogRepository implements ILogRepository {
  async findByUnitId(unitId: number): Promise<Log[]> {
    const q = query(
      collection(db, "logs"),
      where("unitId", "==", unitId),
      orderBy("logDate", "desc")
    );

    const querySnapshot = await getDocs(q);
    return querySnapshot.docs.map(
      (doc) =>
        ({
          id: doc.id,
          ...doc.data(),
        }) as Log
    );
  }

  async create(request: CreateLogRequest): Promise<Log> {
    const docRef = await addDoc(collection(db, "logs"), {
      ...request,
      createdAt: new Date(),
      updatedAt: new Date(),
    });

    return {
      id: docRef.id,
      ...request,
      createdAt: new Date(),
      updatedAt: new Date(),
    } as Log;
  }
}

// ğŸ”§ ç•°ãªã‚‹å®Ÿè£…ã ãŒã€åŒã˜ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æº€ãŸã™
// Supabase â†’ Firebase ã®åˆ‡ã‚Šæ›¿ãˆãŒã“ã“ã ã‘ã§å®Œäº†
```

### 5. Store Configurationï¼ˆä¾å­˜æ³¨å…¥ï¼‰

```typescript
// src/shared/store/index.ts
import { configureStore } from "@reduxjs/toolkit";
import logsReducer from "@/features/logs/application/store/logsSlice";
import { ILogRepository } from "@/features/logs/domain/repositories/ILogRepository";
import { SupabaseLogRepository } from "@/features/logs/infrastructure/repositories/supabaseLogRepository";
// import { FirebaseLogRepository } from '@/features/logs/infrastructure/repositories/firebaseLogRepository';

// ğŸ”„ ä¾å­˜æ³¨å…¥ã®ãƒã‚¤ãƒ³ãƒˆ
const logRepository: ILogRepository = new SupabaseLogRepository();
// const logRepository: ILogRepository = new FirebaseLogRepository(); // åˆ‡ã‚Šæ›¿ãˆã¯ã“ã“ã ã‘

export const store = configureStore({
  reducer: {
    logs: logsReducer,
  },
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware({
      thunk: {
        extraArgument: {
          logRepository, // UseCaseã§ä½¿ç”¨ã•ã‚Œã‚‹
        },
      },
    }),
});

export type RootState = ReturnType<typeof store.getState>;
export type AppDispatch = typeof store.dispatch;

// âš™ï¸ ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯è¨­å®šå¤‰æ›´ã®ãŸã³ã«æ›´æ–°ã•ã‚Œã‚‹
// ã—ã‹ã—ã€æ§‹é€ çš„ã«ã¯éå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«
```

### 6. Presentation Layer ã§ã®ä½¿ç”¨

```typescript
// src/features/logs/presentation/hooks/useLogActions.ts
import { useAppDispatch, useAppSelector } from "@/shared/store/hooks";
import {
  fetchLogsByUnitId,
  createLog,
} from "../../application/useCases/fetchLogsByUnitId";
import { clearError } from "../../application/store/logsSlice";

export const useLogActions = () => {
  const dispatch = useAppDispatch();
  const { logs, loading, error } = useAppSelector((state) => state.logs);

  return {
    logs,
    loading,
    error,
    fetchLogs: (unitId: number) => dispatch(fetchLogsByUnitId(unitId)),
    createLog: (request: CreateLogRequest) => dispatch(createLog(request)),
    clearError: () => dispatch(clearError()),
  };
};
```

```typescript
// src/features/logs/presentation/components/LogsSection.tsx
import { useLogActions } from "../hooks/useLogActions";

export const LogsSection: React.FC<{ unitId: number }> = ({ unitId }) => {
  const { logs, loading, error, fetchLogs, createLog } = useLogActions();

  useEffect(() => {
    fetchLogs(unitId);
  }, [unitId]);

  // UI implementation...
};
```

## ğŸ“Š å¾“æ¥ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã®æ¯”è¼ƒ

### SWR + Direct API Calls

```typescript
// âŒ å¾“æ¥ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
const { data: logs } = useSWR(`/api/units/${unitId}/logs`, fetcher);

// å•é¡Œç‚¹ï¼š
// - APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒå¤‰ã‚ã‚‹ã¨å…¨ã¦ä¿®æ­£ãŒå¿…è¦
// - ãƒ¢ãƒƒã‚¯åŒ–ãŒå›°é›£
// - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒæ•£åœ¨
```

### Redux Toolkit + Clean Architecture

```typescript
// âœ… ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
const { logs } = useLogActions();

// ãƒ¡ãƒªãƒƒãƒˆï¼š
// - å®Ÿè£…ã®å¤‰æ›´ãŒUIã«å½±éŸ¿ã—ãªã„
// - ãƒ†ã‚¹ãƒˆãŒå®¹æ˜“
// - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒé›†ç´„ã•ã‚Œã¦ã„ã‚‹
```

## ğŸ¯ å®Ÿè£…ã®æ©æµ

### 1. **æŠ€è¡“è² å‚µã®å‰Šæ¸›**

- ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®å¤‰æ›´æ™‚ã®å½±éŸ¿ç¯„å›²ãŒé™å®šã•ã‚Œã‚‹
- æ–°æ©Ÿèƒ½è¿½åŠ æ™‚ã®äºˆæ¸¬å¯èƒ½æ€§ãŒå‘ä¸Š

### 2. **ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£ã®å‘ä¸Š**

```typescript
// UseCaseã®ãƒ†ã‚¹ãƒˆä¾‹
const mockRepository: ILogRepository = {
  findByUnitId: jest.fn().mockResolvedValue([mockLog]),
  // ...
};

// Repositoryã‚’ãƒ¢ãƒƒã‚¯åŒ–ã—ã¦ãƒ†ã‚¹ãƒˆå¯èƒ½
```

### 3. **ãƒãƒ¼ãƒ é–‹ç™ºã®åŠ¹ç‡åŒ–**

- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒæ±ºã¾ã‚Œã°ä¸¦è¡Œé–‹ç™ºå¯èƒ½
- è²¬ä»»ç¯„å›²ãŒæ˜ç¢º

## ğŸ“ˆ æ®µéšçš„ç§»è¡Œæˆ¦ç•¥

### Phase 1: Repository Interface ã®å®šç¾©

1. `ILogRepository.ts` ã®ä½œæˆ
2. ç¾åœ¨ã®APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’Repositoryå®Ÿè£…ã«å¤‰æ›

### Phase 2: UseCaseå±¤ã®å°å…¥

1. `createAsyncThunk` ãƒ™ãƒ¼ã‚¹ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ä½œæˆ
2. æ—¢å­˜ã®SWRãƒ•ãƒƒã‚¯ã‚’æ®µéšçš„ã«ç½®ãæ›ãˆ

### Phase 3: å®Œå…¨ç§»è¡Œ

1. å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã‚’RepositoryçµŒç”±ã«å¤‰æ›´
2. SWRã®ä¾å­˜é–¢ä¿‚ã‚’å‰Šé™¤

## ğŸ‰ ã¾ã¨ã‚

Redux Toolkit Ã— ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®çµ„ã¿åˆã‚ã›ã¯ã€ä»¥ä¸‹ã‚’å®Ÿç¾ã—ã¾ã™ï¼š

**ğŸ›¡ï¸ å¤‰åŒ–ã«å¼·ã„è¨­è¨ˆ**

- å¤–éƒ¨ã®å¤‰æ›´ï¼ˆAPIã€DBï¼‰ãŒå†…éƒ¨ã«å½±éŸ¿ã—ãªã„
- æ–°ã—ã„è¦æ±‚ã«æŸ”è»Ÿã«å¯¾å¿œå¯èƒ½

**ğŸ§ª ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„æ§‹é€ **

- ä¾å­˜é–¢ä¿‚ã®æ³¨å…¥ã«ã‚ˆã‚Šãƒ¢ãƒƒã‚¯åŒ–ãŒå®¹æ˜“
- å˜ä½“ãƒ†ã‚¹ãƒˆã‹ã‚‰çµ±åˆãƒ†ã‚¹ãƒˆã¾ã§ç¶²ç¾…å¯èƒ½

**ğŸ‘¥ ãƒãƒ¼ãƒ é–‹ç™ºã®æœ€é©åŒ–**

- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã‚ˆã‚‹æ˜ç¢ºãªå¥‘ç´„
- ä¸¦è¡Œé–‹ç™ºã¨ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®åŠ¹ç‡åŒ–

**ğŸ“š å­¦ç¿’ã‚³ã‚¹ãƒˆã®æŠ•è³‡ä¾¡å€¤**

- åˆæœŸã‚³ã‚¹ãƒˆã¯ã‚ã‚‹ã‚‚ã®ã®ã€é•·æœŸçš„ãªä¿å®ˆæ€§ãŒé£›èºçš„ã«å‘ä¸Š
- ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚‚å¿œç”¨å¯èƒ½ãªæ™®éçš„ãƒ‘ã‚¿ãƒ¼ãƒ³

ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã€Œç†æƒ³è«–ã€ã§ã¯ãªãã€**å®Ÿè·µçš„ãªè§£æ±ºç­–**ã§ã™ã€‚ã‚ãªãŸã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æˆé•·ã¨å…±ã«ã€ã“ã®è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã©ã‚Œã»ã©ä¾¡å€¤ã‚’ç™ºæ®ã™ã‚‹ã‹ã‚’å®Ÿæ„Ÿã—ã¦ã„ãŸã ã‘ã‚‹ã¯ãšã§ã™ã€‚

---

_ã“ã®è¨˜äº‹ãŒã€ã‚ãªãŸã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨­è¨ˆã«ãŠã‘ã‚‹æ–°ãŸãªè¦–ç‚¹ã¨ãªã‚Œã°å¹¸ã„ã§ã™ã€‚è³ªå•ã‚„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ã‚³ãƒ¡ãƒ³ãƒˆãã ã•ã„ï¼_